"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const express_1=__importDefault(require("express")),cors_1=__importDefault(require("cors")),dotenv_1=__importDefault(require("dotenv")),authRoutes_1=__importDefault(require("./routes/authRoutes")),userRoutes_1=__importDefault(require("./routes/userRoutes")),roleRoutes_1=__importDefault(require("./routes/roleRoutes")),portalRoutes_1=__importDefault(require("./routes/portalRoutes")),db_1=require("./config/db");dotenv_1.default.config();const app=(0,express_1.default)(),port=parseInt(process.env.PORT||"3200",10);app.use((0,cors_1.default)()),app.use(express_1.default.json()),app.use("/api/auth",authRoutes_1.default),app.use("/api/users",userRoutes_1.default),app.use("/api/roles",roleRoutes_1.default),app.use("/api/portals",portalRoutes_1.default),app.get("/api",((e,s)=>{s.json({message:"Server is up!"})})),app.post("/api/test-post",((e,s)=>{s.json({message:"POST request successful",receivedData:e.body})})),app.get("/api/test-db",(async(e,s)=>{try{const e=await db_1.poolPromise,t=await e.request().query("SELECT TOP 1 * FROM AspNetUsers");s.json(t.recordset)}catch(e){console.error("DB Error:",e),s.status(500).json({error:e.message})}})),app.use(((e,s,t,r)=>{console.error("Unhandled Error:",e),t.status(500).json({error:e.message})})),app.listen(port,"0.0.0.0",(()=>{console.log(`ðŸš€ API is running on port ${port}`)}));